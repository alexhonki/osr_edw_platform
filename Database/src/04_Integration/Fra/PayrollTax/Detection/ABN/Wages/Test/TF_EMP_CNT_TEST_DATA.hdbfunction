FUNCTION "osr.edw.platform.fra.prt.dt.abn.wages.test::TF_EMP_CNT_TEST_DATA"( )
RETURNS TABLE (
	ABN 				NVARCHAR(11),
	CNT_EMPLOYEE		INTEGER,
	RSDNL_STATE_CD      NVARCHAR(4),
	AGG_GROSS			DECIMAL(15,2),
	INCM_YR 			NVARCHAR(4)
)
       LANGUAGE SQLSCRIPT 
       SQL SECURITY INVOKER AS 
BEGIN 
-- THIS TF IS FOR DEV TESTING PURPOSES ONLY 
-- This makes scrambled data in the TF_EMP_CNT_C table function a little more useful 
-- for test purposes only

RETURN
SELECT 
	"ABN",
	TO_INTEGER(ROUND(("CNT_EMPLOYEE"/1000))) AS "CNT_EMPLOYEE",
	"RSDNL_STATE_CD",
	TO_DECIMAL(ROUND(("AGG_GROSS"/1000),2)) AS "AGG_GROSS",
	CASE 
		WHEN "INCM_YR" <= 246599766 THEN '2015'
		WHEN "INCM_YR" >= 246599766 AND "INCM_YR" <= 490332245 THEN '2016'
		WHEN "INCM_YR" >= 490332245 AND "INCM_YR" <= 717651278 THEN '2017'
		WHEN "INCM_YR" >= 717651278 THEN '2018' 
	END AS "INCM_YR"
FROM "osr.edw.staging.td.ato.proxy::TF_EMP_CNT_C"() ;
	
	
END;